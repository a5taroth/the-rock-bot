# This is the back-end of the backend where all the shit works
# That's why it's called shit

import discord
import random
import json
import response

from urllib.request import urlopen
from discord.ext import commands 

PREFIX="$"

players = []
CHOICE_TYPE=["n", "p", "c"] # for rockball

possible_words = ("rock", "muscle", "exercise", "pancakes")
hangman_word = random.choice(possible_words) 

quote_url = "http://www.famous-quotes.uk/api.php?id=random&minpop=75"

# SETUP
bot = commands.Bot(
  command_prefix = PREFIX, 
  activity = discord.Activity(
    name="Face Off",
    details=f"Use {PREFIX}help to learn more.",
    type=discord.ActivityType.listening
  ),
  status = discord.Status.online
)
bot.remove_command("help")

# Help:

# Ping:


# Pancake
@bot.command(
    name="pancake",
    aliases=["pc", "pancakes"]
)
async def _pancake(ctx):
    _embed=discord.Embed(
        title="We're working on it!9",
        description="This feature is in development."  )
  
    await ctx.channel.send(
        embed=_embed
    )


# Quote
@bot.command(
    name="quote",
    aliases=["quotes", "q"]
)
async def quote(ctx):
    QUOTE = json.load(urlopen(quote_url))[0] 

    # The [0] is because the api returns a nested array
    # QUOTE[0] = ID 
    # QUOTE[1] = Quote
    # QUOTE[2] = Author

    if QUOTE[2]=='': QUOTE[2]="Unknown"

    await ctx.channel.send(
        embed=discord.Embed(
            title="Very inspirational quote",
            description=(
                f"{QUOTE[1]}"
                f"\n\n*- ~~{QUOTE[2]}~~ The Rock*" 
            ),
            color = discord.Color.teal()
        )
    )



# RockBall
@bot.command(
    name="rockball",
    aliases=["ask-8ball", "magic-8ball", "8b", "8-ball", "8ball", "rb"]
)
async def rock_hard_balls(ctx, *, arg:str):
    choice_embed=discord.Embed(
        title="The Almighty Rock Ball     :8ball:"
    )
    
    NPC_CHOICE=random.choice(CHOICE_TYPE)
    if NPC_CHOICE=='n':
        response.choice=random.choice(response.neg)
        choice_embed.color=discord.Color.red()
    elif NPC_CHOICE=='p':
        response.choice=random.choice(response.pos)
        choice_embed.color=discord.Color.green()
    elif NPC_CHOICE=='c':
        response.choice=random.choice(response.non_com)
        choice_embed.color=discord.Color.gold()

    choice_embed.description=response.choice
    choice_embed.set_thumbnail(url="https://discord.com/assets/0cfd4882c0646d504900c90166d80cf8.svg")

    
    await ctx.send(
        embed=choice_embed
    )



# Welcome
@bot.command(
    name="welcome",
    aliases=["w"]
)
async def wellcum(ctx, *, arg:discord.Member):
    welcome_embed=discord.Embed(
        title=f"Welcome {arg.name}!"
    )
    welcome_embed.set_image(
        url=random.choice(
            [
                "https://i.ibb.co/H4fPHq8/welcome-2.jpg",
                "https://images-ext-2.discordapp.net/external/Vdc8YMnwFT0GHN1wvsZZgDcfnG2YiwXEAJ9kM3SZbr4/https/i.ibb.co/T8KD6Hp/welcome.jpg"
            ]
        )
    )

    await ctx.send(
        embed=welcome_embed
    )


# Good Morning
@bot.command(
    name="goodmorning",
    aliases=["gm"]
)
async def gudmorn(ctx):
    gm_embed=discord.Embed(
        title="Hope you have a wonderful day!"
    )
    gm_embed.set_image(
        url=random.choice(
            [
                "https://i.ibb.co/TWbFHtL/gm3.jpg",
                "https://i.ibb.co/44xhwC9/gm2.jpg"
            ]
        )
    )

    await ctx.send(
        embed=gm_embed
    )



# Good Night
@bot.command(
    name="goodnight",
    aliases=["gn"]
)
async def gudnite(ctx):
    gn_embed=discord.Embed(
        title="Have a great night!"
    )
    gn_embed.set_image(
        url=random.choice(
            [
                "https://i.ibb.co/kgw9Fk0/gn1.jpg",
                "https://i.ibb.co/0czbz1V/gn2.jpg"
            ]
        )
    )

    await ctx.send(
        embed=gn_embed
    )




@bot.command(
    name="image",
    help="But first, let me take a selfie!",
    aliases=["img","photo"]
)
async def image(ctx):
    await ctx.channel.send(
        file=discord.File(
            f"images/{random.choice(images.image_paths)}"
        )
    )


@bot.group(
    name="race",
    aliases=["vroom", "vroom-vroom"],
    invoke_without_command=True
)
async def race(ctx, arg:str):
    await ctx.channel.send(
        embed = discord.Embed(
            title = "Bumpy Ride by ~~Mohambi~~ The Rock", 
            description = "Atleast two players needed to begin.",
            color = discord.Color.red()
        )
    )


@race.command(
    name="start",
    aliases=["begin", "s"]
)
async def race_start(ctx):
    await ctx.send("Starting the race.")


@bot.command(
    name="hangman",
    aliases=["hm", "manhang?"]
)
async def hang_the_man(ctx):
    await ctx.send(
        embed=discord.Embed(
            title="Hangman",
            description="This feature is in development."
        )
    )
